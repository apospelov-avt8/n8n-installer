# --- Базовое ---
http_port 3128
via on
forwarded_for off

# Разрешаем из docker-сети / localhost
acl localnet src 127.0.0.1/32
acl localnet src 10.0.0.0/8
acl localnet src 172.16.0.0/12
acl localnet src 192.168.0.0/16
http_access allow localnet
http_access deny all

# --- Родительский (защищённый) прокси ---
cache_peer 45.147.100.171 parent 8000 0 login=XXXX:YYYYYY name=paidproxy

# --- Route Anthropic/Claude via parent ---
acl to_proxy dstdomain .anthropic.com .claude.ai .openai.com .cohere.com .cohere.ai .googleapis.com
cache_peer_access paidproxy allow to_proxy
cache_peer_access paidproxy deny all
never_direct allow to_proxy
always_direct deny to_proxy
# --- end route ---

# DNS
dns_nameservers 1.1.1.1 8.8.8.8
